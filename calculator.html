<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>InsightÂ® : Business Done Right</title>
          <link rel="stylesheet" href="styles/calculator.css">
          <link rel="stylesheet" href="styles/navbar.css">
          <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
    </head>

    <body>
        <header>  
            <nav>
                <ul class="navigation">
                    <li class="logo"> <a href="index.html"> Insight Logo</a> </li>
                    <li> <a href="index.html"> <b>Home</b> </a> </li>
                    <li> <a href="how_to_use.html"> <b>How To Use</b> </a> </li>
                    <li> <a href="contact_us.html"> <b>Contact Us</b> </a> </li>
                    <li> <a href="about.html"> <b>About</b> </a> </li>
                    <li class="username"> <a href=""> <b>user37921</b> </a> </li>
                </ul>
            </nav>
        </header>
        
  <section>


<div class="container">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <button class="tablink business" onclick="openPage('business', this, 'rgb(209, 209, 209)')"id="defaultOpen">Business</button>
  <button class="tablink metrics" onclick="openPage('metrics', this, 'rgb(192, 191, 191)')">Metrics</button>
  <button class="tablink expenses" onclick="openPage('expenses', this, 'rgb(173, 173, 173)')">Expenses</button>
  <button class="tablink results" >Results</button>

  <div id="business" class="tabcontent">
              <!-- intro tab -->
              <div class="content">
                <div class="business-type">
                  <h4>Get started</h4>
                  <label for="business">What type of business do you operate?</label>
                  <select name="businesstype" id="businesstype" >
                    <option disabled selected>Select one &#9660;</option>
                    <option value="fast-food">Fast food chain</option>
                    <option value="local">Local restaurant</option>
                    <option value="luxury">High-end restaurant</option>
                    <option value="store">Retail</option>
                  </select>
                  <div class="select-icon"></div>
                </div>
  
                <div class="product-type">
                  <label for="producttype">What product are you trying to determine the price for?</label>
                  <select name="product-type" id="product-type">
                    <option disabled selected>Select one &#9660;</option>
                    <option value="burger">Burger (beef)</option>
                    <option value="sandwich">Sandwich</option>
                    <option value="fries">French fries</option>
                    <option value="drink">Beverage</option>
                    <option value="drink">Hot Dog</option>
                    <option value="other">Other</option>
                  </select>
                </div>
                <div class="next-prev">
                  <button class="next" onclick="openPage('metrics', this, 'rgb(163, 163, 163)')">Next &raquo;</button>
                </div>
              </div>
            </div>

  <div id="metrics" class="tabcontent">
    <div class="row">
      <div class="column">
        <h4 style="margin-top: 30px;">Let's talk business</h4>

        <br>

        <label for="lastmonth">Total units sold last month:</label>
        <input style="margin-left: 20px;" type="number" id="lastmonth" name="lastmonth">
        <br>
        
        <label for="lastmonth-lastyear">Total last month a year ago:</label>
        <input style="margin-left: 9px;" type="number" id="lastmonth-lastyear" name="lastmonth-lastyear">
        <br>

        <label for="nextmonth-lastyear">Total next month a year ago:</label>
        <input type="number" id="nextmonth-lastyear" name="nextmonth-lastyear">
        <br>
        <button style="margin-left: 315px; margin-bottom: 20px;" class="update" id="update">update</button>

        <div class="next-prev">
          <button class="previous" onclick="openPage('business', this, 'rgb(163, 163, 163)')">&laquo; Previous</button>
          <button class="next" onclick="openPage('expenses', this, 'rgb(163, 163, 163)')">Next &raquo;</button>
        </div>
      </div>
        
      <div class="column">
        <div class="output" style="margin-top: 170px; margin-left: 2px;">
          <label for="unit-estimate">Estimated units that will be sold next month:</label>
          <p class="unit-estimate" style="color: rgba(19,119,250,1);" id="unit_estimate">00 units.</p>

          <label for="yoy"> Percentage of change in sales: </label>
          <p style="color: white;" class="change" id="change"> 00.00%</p>

       </div>  
      </div>
    </div>

  </div>

    <div id="expenses" class="tabcontent">
      <div class="row">
        <div class="column">
          <h4 style="margin-top: 30px;">Expenses</h4>
          <label for="materialcost">Raw material cost per unit:</label>
          <div class="tooltip">
            <input type="number" id="materialcost" name="materialcost">
            <span style="text-align: center;" class="tooltiptext">This is the amount it costs for each unit produced</span>
          </div>
          <br>
          <label for="fixed-monthly">Fixed monthly costs:</label>
          <div class="tooltip">
            <input style="margin-left: 65px;" type="number" id="fixed-monthly">
            <span style="text-align: center;" class="tooltiptext">Includes monthly rent, utility/bills, insurance</span>
          </div>
          <br>
          <div class="next-prev">
            <button  class="previous" onclick="openPage('metrics', this, 'rgb(163, 163, 163)')">&laquo; Previous</button>
          </div>
        </div>

        <div style="margin-top: 158px;" class="column">
          <label for="covid-cost">Monthly COVID-19 cost:</label>
          <div class="tooltip">
            <input style="margin-left: 95px;" type="number" id="covid-cost">
            <span style="text-align: center;" class="tooltiptext">PPE equipment(masks, gloves, etc..), sanitation, and any other expenses due to COVID-19</span>
          </div>
          <br>

          <label for="labor">Monthly labor costs: (on average)</label>
          <div class="tooltip">
            <input type="number" id="labor">
            <span style="text-align: center;" class="tooltiptext">Sum of all employee wages, benefits, and/or payroll taxes</span>
          </div>


          <button style="margin-left: 370px; margin-bottom: 10px;" id="submit" class="submit" onclick="openPage('results', this, 'rgb(163, 163, 163)')">See Results</button>
        </div>
      </div>
  </div>

    <div id="results" class="tabcontent">
      <h4>Here's what we found:</h4>
      <div style="justify-content: center;" class="result">
      <p class="breakeven" id="breakeven">Your break-even price:</p>
    
      <div class="row" style="padding-bottom: 50px;">
        <div class="column options">
          <label for="">Profit margin:</label>
          <br>
          <br>
          <div class="profit-btn" id="profit-btn">
            <button onclick=" return priceGenerator(00)" class="profit-btn-child active2">0%</button>
            <button onclick=" return priceGenerator(.05)" class="profit-btn-child">5%</button>
            <button onclick=" return priceGenerator(.1)" class="profit-btn-child">10%</button>
            <button onclick=" return priceGenerator(.15)" class="profit-btn-child">15%</button>
            <button onclick=" return priceGenerator(.20)" class="profit-btn-child">20%</button>
            <input type="number" id="profit-btn-input" placeholder="%" class="inputBtn">
          </div>

          <br>
          <br>
          <label for="">Change in units sold next month:</label>
          <br>
          <br>
          <div class="price-btn" id="price-btn">
            <button onclick=" return marginGenerator(00)" class="price-btn-child active">Current</button>
            <button onclick=" return marginGenerator(.05)" class="price-btn-child">5%</button>
            <button onclick=" return marginGenerator(.1)" class="price-btn-child">10%</button>
            <button onclick=" return marginGenerator(.15)" class="price-btn-child">15%</button>
            <button onclick=" return marginGenerator(.20)" class="price-btn-child">20%</button>
            <input type="number" id="mgn-btn-input" placeholder="%" class="inputBtn">

          </div>
          <br>
          <p style="margin-top: 20px; color: rgba(19,119,250,1);" id="percent-change-unit">Estimated units sold next month: </p>
          <p style="margin-top: 25px; color: rgba(19,119,250,1);" id="price-output">Price at selected profit margin:</p>
          <p style="margin-top: 25px; color: rgba(19,119,250,1);" id="percent-change-price">New price at adjusted unit projection: </p>

        </div>

        <div class="column chart">
          <div style="margin-right: 20px; margin-top: 50px;" id="chart"></div>
        </div>
      </div>
    </div>
</div>

<script>
  var fixedMonthly, labor, covidCost, nextMonth, material, lastMonth, lastYear, nextMonth, globalBkPrice, chart;
  var blueDummy =  [0, 1.63, 1.28, .86, .75, 2.13];
  var greenDummy = [0, .57, .23, 1.02, 1.15, .11];
  var globalProfitMargin = 0 ;
  var moneyIcon = '$';
  var catNames = ['Burger(Beef)', 'sandwich', 'French Fries', 'Beverage', 'Hot Dog', 'Other'];

  function openPage(pageName, elmnt, color) {
      var i, tabcontent, tablinks;
      tabcontent = document.getElementsByClassName("tabcontent");
      for (i = 0; i < tabcontent.length; i++) {
          tabcontent[i].style.display = "none";
      }
      tablinks = document.getElementsByClassName("tablink");
      for (i = 0; i < tablinks.length; i++) {
          tablinks[i].style.backgroundColor = "";
      }
      document.getElementById(pageName).style.display = "block";
      elmnt.style.backgroundColor = color;
  }
  
  //add remove class on result page
      var btnContainer = document.getElementById("price-btn");
      var btns = btnContainer.getElementsByClassName("price-btn-child");

      var btnContainer2 = document.getElementById("profit-btn");
      var btns2 = btnContainer2.getElementsByClassName("profit-btn-child");
      function addRemoveClassOnResults() {

      // Loop through the buttons and add the active class to the current/clicked button
      for (var i = 0; i < btns.length; i++) {
          btns[i].addEventListener("click", function() {
              var current = document.getElementsByClassName("active");
              current[0].className = current[0].className.replace(" active", "");
              this.className += " active";
//                document.getElementById("mgn-btn-input").classList.remove("active");
          });
      }

      // Loop through the buttons and add the active class to the current/clicked button
      for (var i = 0; i < btns2.length; i++) {
          btns2[i].addEventListener("click", function() {
              var current2 = document.getElementsByClassName("active2");
              current2[0].className = current2[0].className.replace(" active2", "");
              this.className += " active2";
//                document.getElementById("profit-btn-input").classList.remove("active");
          });
      }
          
  }

  document.getElementById("update").addEventListener("click", function() {
        material = document.getElementById("materialcost").value;
        lastMonth = document.getElementById("lastmonth").value;
        lastYear = document.getElementById("lastmonth-lastyear").value;
        nextMonth = document.getElementById("nextmonth-lastyear").value;

      var percentChange = (lastMonth - lastYear) / lastYear;
      var estimateNextMonth = Math.floor(nextMonth * percentChange) + parseFloat(nextMonth);

      if (percentChange < 0) {
          document.getElementById("change").innerHTML =
              (Math.round((percentChange * 100), 2) + "%").fontcolor("red");
          document.getElementById("unit_estimate").innerHTML = estimateNextMonth + " units.";
      } else {
          document.getElementById("change").innerHTML =
              (Math.round((percentChange * 100), 2) + "%").fontcolor("green");
          document.getElementById("unit_estimate").innerHTML = estimateNextMonth + " units.";
      }

  });
  
   document.getElementById("profit-btn-input").addEventListener("change", function(e) {
       var val = document.getElementById("profit-btn-input").value;
       if (isNaN(val) || val == null || val == "") {

       } else {
           priceGenerator(val/100);
       }
   });
  document.getElementById("mgn-btn-input").addEventListener("change", function(e) {
       var val = document.getElementById("mgn-btn-input").value;
       if (isNaN(val) || val == null || val == "") {
       } else {
            marginGenerator(val/100);
       }
   });
  
  
  document.getElementById("submit").addEventListener("click", function() {
        fixedMonthly = document.getElementById("fixed-monthly").value;
        labor = document.getElementById("labor").value;
        covidCost = document.getElementById("covid-cost").value;
        nextMonth = document.getElementById("nextmonth-lastyear").value;

      var percentChange = (lastMonth - lastYear) / lastYear;
      var estimateNextMonth = Math.floor(nextMonth * percentChange) + parseFloat(nextMonth);


      var cost = (labor * 1.00) + (fixedMonthly * 1.00) + (covidCost * 1.00);
      var breakEven = (cost * 1.00) / (estimateNextMonth * 1.00) + (material * 1.00);
      breakEven = breakEven.toFixed(2);
      globalBkPrice = breakEven;
      globalProfitMargin = globalBkPrice; // on page load default profit margin is zero hence difference should be zero
      document.getElementById("breakeven").innerHTML = "Your break-even price: $" + breakEven;
      document.getElementById("percent-change-unit").innerHTML = "Estimated units sold next month: " + estimateNextMonth;
      initialChartLoad();
  });

  function priceGenerator(x) {
      var percentChange = (lastMonth - lastYear) / lastYear;
      var estimateNextMonth = Math.floor(nextMonth * percentChange) + parseFloat(nextMonth);
      var cost = (labor * 1.00) + (fixedMonthly * 1.00) + (covidCost * 1.00);
      var breakEven = (cost * 1.00) / (estimateNextMonth * 1.00) + (material * 1.00);
      var profitMgn = ((x * breakEven) + breakEven).toFixed(2);
      document.getElementById("price-output").innerHTML = "Price at selected profit margin: $" + profitMgn;
      var difference = profitMgn - globalBkPrice;
      globalProfitMargin = profitMgn;
      if ( difference == 0) {
          greenDummy[0] = 0;
      } else {
          greenDummy[0] = difference.toFixed(2);
      }
      blueDummy[0] = globalBkPrice;
      chart.updateSeries([{
          data: blueDummy,
      }, {
          data: greenDummy,
      }]);
  }

  function marginGenerator(y) {
      var percentChange = (lastMonth - lastYear) / lastYear;
      var estimateNextMonth = Math.floor(nextMonth * percentChange) + parseFloat(nextMonth);
      var cost = (labor * 1.00) + (fixedMonthly * 1.00) + (covidCost * 1.00);
      var newEstimate = Math.floor(estimateNextMonth * y) + parseFloat(estimateNextMonth);
      var breakEven = ((cost * 1.00) / (newEstimate * 1.00)) + (material * 1.00);
      breakEven = breakEven.toFixed(2);
      document.getElementById("percent-change-price").innerHTML = "New price at adjusted unit projection: " + "(" + newEstimate + " units) $" + breakEven;
      document.getElementById("breakeven").innerHTML = "Your break-even price: $" + breakEven;
      globalBkPrice = breakEven;
      var difference = globalProfitMargin - globalBkPrice;
      if ( difference == 0) {
          greenDummy[0] = 0;
      } else {
          greenDummy[0] = difference.toFixed(2);
      }
      blueDummy[0] = globalBkPrice;
      chart.updateSeries([{
          data: blueDummy,
      }, {
          data: greenDummy,
      }]);
  }
  
  function initialChartLoad() {
      //chart options
      blueDummy[0] = globalBkPrice;
      var options = {
          series: [{
              name: 'Breakeven',
              data: blueDummy
          }, {
              name: 'Profit',
              data: greenDummy,
          }],
          dataLabels: {
              formatter: function(val) {
                      return moneyIcon + val 
              }
          },
          chart: {
              type: 'bar',
              height: 400,
              stacked: true,
          },
          plotOptions: {
              bar: {
                  horizontal: false,
              },
          },
          stroke: {
              width: 1,
              colors: ['#fff']
          },
          title: {
              text: 'Break Even Analysis'
          },
          xaxis: {
              categories: catNames,
              title: {
                  text: 'Product'
              },
          },
          yaxis: {
              title: {
                  text: 'Price'
              },
              labels: {
                  formatter: function(val) {
                      return moneyIcon + val 
                  }
              },
          },
          colors: ['rgb(0, 143, 251)', '#00b289'],
          fill: {
              opacity: 1,
          },
          legend: {
              show: false,
          }
      }
      chart = new ApexCharts(document.querySelector("#chart"), options);
      chart.render();
  }


  
  // call functions on page load
  document.getElementById("defaultOpen").click();
//    document.getElementById("update").click();
//    document.getElementById("submit").click();
  addRemoveClassOnResults();
</script>

</div>

      </section>

    </body>
</html>